<?xml version="1.0" encoding="utf-8"?>
<Patch>
	<!-- add guaranteed nano forges to bulk goods traders -->
	<Operation Class="PatchOperationAdd">
	    <xpath>Defs/TraderKindDef[defName = "Orbital_BulkGoods"]/stockGenerators</xpath>
	    <value>
			<li Class="StockGenerator_SingleDef">
				<thingDef>D9NanoForge</thingDef>
				<price>Expensive</price>
				<countRange>
				  <min>1</min>
				  <max>1</max>
				</countRange>
			</li>
			<li Class="StockGenerator_SingleDef">
				<thingDef>D9Nanomaterial</thingDef>
				<countRange>
				  <min>50</min>
				  <max>150</max>
				</countRange>
			</li>
			<li Class="StockGenerator_SingleDef">
				<thingDef>AIPersonaFragment</thingDef>
				<countRange>
				  <min>2</min>
				  <max>5</max>
				</countRange>
			</li>
	    </value>
	</Operation>
	<!-- ditto but for exotic traders -->
	<Operation Class="PatchOperationAdd">
	    <xpath>Defs/TraderKindDef[defName = "Orbital_Exotic"]/stockGenerators</xpath>
	    <value>
			<li Class="StockGenerator_SingleDef">
				<thingDef>D9NanoForge</thingDef>
				<countRange>
				  <min>1</min>
				  <max>3</max>
				</countRange>
			</li>
			<li Class="StockGenerator_SingleDef">
				<thingDef>AIPersonaFragment</thingDef>
				<price>Cheap</price>
				<countRange>
				  <min>3</min>
				  <max>6</max>
				</countRange>
			</li>
	    </value>
	</Operation>
	<!-- allow AI Persona Cores to be sold by traders -->
	<Operation Class="PatchOperationSequence"> <!-- for Misc. Robots compat (they do the same thing but remove tradeability instead) -->
		<success>Always</success>
		<operations>
			<li Class="PatchOperationTest">
				<xpath>Defs/ThingDef[defName="AIPersonaCore"]/tradeability</xpath>
				<success>Invert</success>
			</li>
			<li Class="PatchOperationReplace">
				<xpath>Defs/ThingDef[defName = "AIPersonaCore"]/tradeability</xpath>
				<value>
					<tradeability>All</tradeability>
				</value>
			</li>
		</operations>
	</Operation>
	<!-- prevent additional ones from being generated from the ExoticMisc tag -->
	<Operation Class="PatchOperationAdd">
	    <xpath>Defs/TraderKindDef[defName = "Orbital_Exotic"]/stockGenerators/li[tradeTag="ExoticMisc"]/excludedThingDefs</xpath>
	    <value>
			<li>D9NanoForge</li>
			<li>AIPersonaFragment</li>
	    </value>
	</Operation>
	<Operation Class="PatchOperationAdd">
	    <xpath>Defs/TraderKindDef[defName = "Orbital_Exotic"]/stockGenerators/li[tradeTag="ExoticMisc"]/customCountRanges</xpath>
	    <value>
			<AIPersonaCore>1~1</AIPersonaCore>
			<Vanadite>50~125</Vanadite>
			<D9Nanomaterial>75~200</D9Nanomaterial>
			<D9VanometricCell>2~5</D9VanometricCell>
			<Nanoweave>25~125</Nanoweave>
			<Insulene>100~300</Insulene>
			<PsychicFoil>75~150</PsychicFoil>
	    </value>
	</Operation>
	<!-- generate more ExoticMisc goods so the new items don't crowd out old ones -->
	<Operation Class="PatchOperationReplace">
	    <xpath>Defs/TraderKindDef[defName = "Orbital_Exotic"]/stockGenerators/li[tradeTag="ExoticMisc"]/thingDefCountRange</xpath>
	    <value>
			<thingDefCountRange>
			  <min>5</min>
			  <max>8</max>
			</thingDefCountRange>
	    </value>
	</Operation>
</Patch>